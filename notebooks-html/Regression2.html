<div id="ipython-notebook">
            <a class="interact-button" href="http://data8.berkeley.edu/hub/interact?repo=textbook&subPath=notebooks/hodgkins.csv&subPath=notebooks/Regression2.ipynb&branch=gh-pages">Interact</a>
            
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\(','\)']],
      processEscapes: true
    }
  });
</script>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id='Assumptions-of-randomness:-a-"regression-model"'>Assumptions of randomness: a "regression model"<a class="anchor-link" href='#Assumptions-of-randomness:-a-"regression-model"'>¶</a></h2><p>In the last section, we developed the concepts of correlation and regression as ways to describe data. We will now see how these concepts can become powerful tools for inference, when used appropriately.</p>
<p>Questions of inference may arise if we believe that a scatter plot reflects the underlying relation between the two variables being plotted but does not specify the relation completely. For example, a scatter plot of the heights of fathers and sons shows us the precise relation between the two variables in one particular sample of men; but we might wonder whether that relation holds true, or almost true, among all fathers and sons in the population from which the sample was drawn, or indeed among fathers and sons in general.</p>
<p>As always, inferential thinking begins with a careful examination of the assumptions about the data. Sets of assumptions are known as <em>models</em>. Sets of assumptions about randomness in roughly linear scatter plots are called <em>regression models</em>.</p>
<p>In brief, such models say that the underlying relation between the two variables is perfectly linear; this straight line is the <em>signal</em> that we would like to identify. However, we are not able to see the line clearly. What we see are points that are scattered around the line. In each of the points, the signal has been contaminated by <em>random noise</em>. Our inferential goal, therefore, is to separate the signal from the noise.</p>
<p>In greater detail, the regression model specifies that the points in the scatter plot are generated at random as follows.</p>
<ul>
<li>The relation between $x$ and $y$ is perfectly linear. We cannot see this "true line" but Tyche can. She is the Goddess of Chance.</li>
<li>Tyche creates the scatter plot by taking points on the line and pushing them off the line vertically, either above or below, as follows:<ul>
<li>For each $x$, Tyche finds the corresponding point on the true line, and then adds an error.</li>
<li>The errors are drawn at random with replacement from a population of errors that has a normal distribution with mean 0.</li>
<li>Tyche creates a point whose horizontal coordinate is $x$ and whose vertical coordinate is "the height of the true line at $x$, plus the error".</li>
</ul>
</li>
<li>Finally, Tyche erases the true line from the scatter, and shows us just the scatter plot of her points.</li>
</ul></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on this scatter plot, how should we estimate the true line? The best line that we can put through a scatter plot is the regression line. So the regression line is a natural estimate of the true line.</p>
<p>The simulation below shows how close the regression line is to the true line. The first panel shows how Tyche generates the scatter plot from the true line; the second show the scatter plot that we see; the third shows the regression line through the plot; and the fourth shows both the regression line and the true line.</p>
<p>Run the simulation a few times, with different values for the slope and intercept of the true line, and varying sample sizes. You will see that the regression line is a good estimate of the true line if the sample size is moderately large.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">draw_and_compare</span><span class="p">(</span><span class="n">true_slope</span><span class="p">,</span> <span class="n">true_int</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>
    <span class="n">xlims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">true_slope</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">true_int</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span>
    <span class="n">tyche</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],[</span><span class="s">'x'</span><span class="p">,</span><span class="s">'y'</span><span class="p">])</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tyche</span><span class="p">[</span><span class="s">'x'</span><span class="p">],</span> <span class="n">tyche</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span> <span class="n">true_slope</span><span class="o">*</span><span class="n">xlims</span> <span class="o">+</span> <span class="n">true_int</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'gold'</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'What Tyche draws'</span><span class="p">)</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tyche</span><span class="p">[</span><span class="s">'x'</span><span class="p">],</span><span class="n">tyche</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'What we get to see'</span><span class="p">)</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">scatter_fit</span><span class="p">(</span><span class="n">tyche</span><span class="p">,</span> <span class="s">'x'</span><span class="p">,</span> <span class="s">'y'</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Regression line: our estimate of true line'</span><span class="p">)</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">scatter_fit</span><span class="p">(</span><span class="n">tyche</span><span class="p">,</span> <span class="s">'x'</span><span class="p">,</span> <span class="s">'y'</span><span class="p">)</span>
    <span class="n">xlims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tyche</span><span class="p">[</span><span class="s">'x'</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tyche</span><span class="p">[</span><span class="s">'x'</span><span class="p">])])</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span> <span class="n">true_slope</span><span class="o">*</span><span class="n">xlims</span> <span class="o">+</span> <span class="n">true_int</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'gold'</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Regression line and true line"</span><span class="p">)</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Tyche's true line,</span>
<span class="c"># the points she creates,</span>
<span class="c"># and our estimate of the true line.</span>
<span class="c"># Arguments: true slope, true intercept, number of points</span>

<span class="n">draw_and_compare</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_11_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In reality, of course, we are not Tyche, and we will never see the true line. What the simulation shows that if the regression model looks plausible, and we have a large sample, then regression line is a good approximation to the true line.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is an example where regression model can be used to make predictions.</p>
<p>The data are a subset of the information gathered in a randomized controlled trial about treatments for Hodgkin's disease. Hodgkin's disease is a cancer that typically affects young people. The disease is curable but the treatment is very harsh. The purpose of the trial was to come up with dosage that would cure the cancer but minimize the adverse effects on the patients.</p>
<p>This table <code>hodgkins</code> contains data on the effect that the treatment had on the lungs of 22 patients. The columns are:</p>
<ul>
<li>Height in cm</li>
<li>A measure of radiation to the mantle (neck, chest, under arms)</li>
<li>A measure of chemotherapy</li>
<li>A score of the health of the lungs at baseline, that is, at the start of the treatment; higher scores correspond to more healthy lungs</li>
<li>The same score of the health of the lungs, 15 months after treatment</li>
</ul></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">hodgkins</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s">'hodgkins.csv'</span><span class="p">)</span>
<span class="n">hodgkins</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>height</th> <th>rad</th> <th>chemo</th> <th>base</th> <th>month15</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>164   </td> <td>679 </td> <td>180  </td> <td>160.57</td> <td>87.77  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>168   </td> <td>311 </td> <td>180  </td> <td>98.24 </td> <td>67.62  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>173   </td> <td>388 </td> <td>239  </td> <td>129.04</td> <td>133.33 </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>157   </td> <td>370 </td> <td>168  </td> <td>85.41 </td> <td>81.28  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>160   </td> <td>468 </td> <td>151  </td> <td>67.94 </td> <td>79.26  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>170   </td> <td>341 </td> <td>96   </td> <td>150.51</td> <td>80.97  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>163   </td> <td>453 </td> <td>134  </td> <td>129.88</td> <td>69.24  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>175   </td> <td>529 </td> <td>264  </td> <td>87.45 </td> <td>56.48  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>185   </td> <td>392 </td> <td>240  </td> <td>149.84</td> <td>106.99 </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>178   </td> <td>479 </td> <td>216  </td> <td>92.24 </td> <td>73.43  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>179   </td> <td>376 </td> <td>160  </td> <td>117.43</td> <td>101.61 </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>181   </td> <td>539 </td> <td>196  </td> <td>129.75</td> <td>90.78  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>173   </td> <td>217 </td> <td>204  </td> <td>97.59 </td> <td>76.38  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>166   </td> <td>456 </td> <td>192  </td> <td>81.29 </td> <td>67.66  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>170   </td> <td>252 </td> <td>150  </td> <td>98.29 </td> <td>55.51  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>165   </td> <td>622 </td> <td>162  </td> <td>118.98</td> <td>90.92  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>173   </td> <td>305 </td> <td>213  </td> <td>103.17</td> <td>79.74  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>174   </td> <td>566 </td> <td>198  </td> <td>94.97 </td> <td>93.08  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>173   </td> <td>322 </td> <td>119  </td> <td>85    </td> <td>41.96  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>173   </td> <td>270 </td> <td>160  </td> <td>115.02</td> <td>81.12  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>183   </td> <td>259 </td> <td>241  </td> <td>125.02</td> <td>97.18  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>188   </td> <td>238 </td> <td>252  </td> <td>137.43</td> <td>113.2  </td>
        </tr>
    </tbody>
</table></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is evident that the patients' lungs were less healthy 15 months after the treatment than at baseline. At 36 months, they did recover most of their lung function, but those data are not part of this table.</p>
<p>The scatter plot below shows that taller patients had higher scores at 15 months.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">scatter_fit</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">,</span> <span class="s">'height'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_16_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prediction">Prediction<a class="anchor-link" href="#Prediction">¶</a></h3><p>The scatter plot looks roughly linear. Let us assume that the regression model holds. Under that assumption, the regression line can be used to predict the 15-month score of a new patient, based on the patient's height. The prediction will be good provided the assumptions of the regression model are justified for these data, and provided the new patient is similar to those in the study.</p>
<p>The function <code>regress</code> gives us the slope and intercept of the regression line. To predict the 15-month score of a new patient whose height is $x$ cm, we use the following calculation:</p>
<p>Predicted 15-month score of a patient who is $x$ inches tall
$~=~$ slope$\;\times\;x ~+~$ intercept</p>
<p>The predicted 15-month score of a patient who is 173 cm tall is 83.66 cm, and that of a patient who is 163 cm tall is 73.69 cm.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># slope and intercept</span>
<span class="n">slope_int</span> <span class="o">=</span> <span class="n">regress</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">,</span> <span class="s">'height'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">)</span>
<span class="n">slope_int</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>array([  0.99626375, -88.69663156])</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># New patient, 173 cm tall</span>
<span class="c"># Predicted 15-month score:</span>

<span class="n">slope_int</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">173</span> <span class="o">+</span> <span class="n">slope_int</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>83.65699801460444</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># New patient, 163 cm tall</span>
<span class="c"># Predicted 15-month score:</span>

<span class="n">slope_int</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">163</span> <span class="o">+</span> <span class="n">slope_int</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>73.694360467072741</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Variability-of-the-Prediction">The Variability of the Prediction<a class="anchor-link" href="#The-Variability-of-the-Prediction">¶</a></h2><p>As data scientists working under the regression model, we know that the sample might have been different. Had the sample been different, the regression line would have been different too, and so would our prediction. To see how good our prediction is, we must get a sense of how variable the prediction can be.</p>
<p>One way to do this would be by generating new random samples of points and making a prediction based on each new sample. To generate new samples, we can <strong>bootstrap the scatter plot</strong>.</p>
<p>Specifically, we can simulate new samples by random sampling with replacement from the original scatter plot, as many times as there are points in the scatter.</p>
<p>Here is the original scatter diagram from the sample, and four replications of the bootstrap resampling procedure. Notice how the resampled scatter plots are in general a little more sparse than the original. That is because some of the original point do not get selected in the samples.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">plots</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">[</span><span class="s">'height'</span><span class="p">],</span> <span class="n">hodgkins</span><span class="p">[</span><span class="s">'month15'</span><span class="p">])</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Original sample'</span><span class="p">)</span>

<span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rep</span><span class="p">[</span><span class="s">'height'</span><span class="p">],</span> <span class="n">rep</span><span class="p">[</span><span class="s">'month15'</span><span class="p">])</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Bootstrap sample 1'</span><span class="p">)</span>

<span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rep</span><span class="p">[</span><span class="s">'height'</span><span class="p">],</span> <span class="n">rep</span><span class="p">[</span><span class="s">'month15'</span><span class="p">])</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Bootstrap sample 2'</span><span class="p">)</span>

<span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rep</span><span class="p">[</span><span class="s">'height'</span><span class="p">],</span> <span class="n">rep</span><span class="p">[</span><span class="s">'month15'</span><span class="p">])</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Bootstrap sample 3'</span><span class="p">)</span>

<span class="n">plots</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rep</span><span class="p">[</span><span class="s">'height'</span><span class="p">],</span> <span class="n">rep</span><span class="p">[</span><span class="s">'month15'</span><span class="p">])</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Bootstrap sample 4'</span><span class="p">)</span>
<span class="k">None</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_22_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next step is to fit the regression line to the scatter plot in each replication, and make a prediction based on each line. The figure below shows 10 such lines, and the corresponding predicted 15-month scores for a patient whose height is 173 cm.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">x</span> <span class="o">=</span> <span class="mi">173</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="p">[</span><span class="s">'height'</span><span class="p">]</span>
<span class="n">m15</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="p">[</span><span class="s">'month15'</span><span class="p">]</span>
<span class="n">xlims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">h</span><span class="p">)])</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([[],[]],</span> <span class="p">[</span><span class="s">'slope'</span><span class="p">,</span><span class="s">'intercept'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">from_rows</span><span class="p">([</span><span class="n">regress</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="s">'height'</span><span class="p">,</span><span class="s">'month15'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'slope'</span><span class="p">,</span><span class="s">'intercept'</span><span class="p">]))</span>
<span class="n">results</span><span class="p">[</span><span class="s">'prediction at x='</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s">'slope'</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">results</span><span class="p">[</span><span class="s">'intercept'</span><span class="p">]</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">results</span><span class="p">[</span><span class="s">'slope'</span><span class="p">]</span> <span class="o">+</span> <span class="n">results</span><span class="p">[</span><span class="s">'intercept'</span><span class="p">]</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">results</span><span class="p">[</span><span class="s">'slope'</span><span class="p">]</span> <span class="o">+</span> <span class="n">results</span><span class="p">[</span><span class="s">'intercept'</span><span class="p">]</span>
<span class="n">fit_x</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">results</span><span class="p">[</span><span class="s">'slope'</span><span class="p">]</span> <span class="o">+</span> <span class="n">results</span><span class="p">[</span><span class="s">'intercept'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit_x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_24_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The table below shows the slope and intercept of each of the 10 lines, along with the prediction.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">results</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>slope</th> <th>intercept</th> <th>prediction at x=173</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0.302312</td> <td>19.2218  </td> <td>71.5218            </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.82256 </td> <td>-59.5651 </td> <td>82.7378            </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.680512</td> <td>-42.3011 </td> <td>75.4275            </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.622213</td> <td>-28.2055 </td> <td>79.4373            </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>1.01322 </td> <td>-94.2791 </td> <td>81.008             </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.964129</td> <td>-84.2893 </td> <td>82.505             </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.553561</td> <td>-17.8059 </td> <td>77.9602            </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>1.03424 </td> <td>-99.4017 </td> <td>79.522             </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.993966</td> <td>-98.402  </td> <td>73.554             </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0.938993</td> <td>-73.1735 </td> <td>89.2723            </td>
        </tr>
    </tbody>
</table></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bootstrap-prediction-interval">Bootstrap prediction interval<a class="anchor-link" href="#Bootstrap-prediction-interval">¶</a></h2></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we increase the number of repetitions of the resampling process, we can generate an empirical histogram of the predictions. This will allow us to create a prediction interval, by the same methods that we used earlier to create bootstrap confidence intervals for numerical parameters.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># Bootstrap prediction at new_x</span>
<span class="c"># Hodgkin's disease table, x = height, y = month15</span>

<span class="k">def</span> <span class="nf">bootstrap_ht_m15</span><span class="p">(</span><span class="n">new_x</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">):</span>
    
    <span class="c"># For each repetition:</span>
    <span class="c"># Bootstrap the scatter; </span>
    <span class="c"># get the regression prediction at new_x; </span>
    <span class="c"># augment the predictions list</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
        <span class="n">bootstrap_sample</span> <span class="o">=</span> <span class="n">hodgkins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">fit</span><span class="p">(</span><span class="n">bootstrap_sample</span><span class="p">,</span> <span class="s">'height'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">,</span> <span class="n">new_x</span><span class="p">)</span>
        <span class="n">pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    
    <span class="c"># Prediction based on original sample</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">fit</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">,</span> <span class="s">'height'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">,</span> <span class="n">new_x</span><span class="p">)</span>
    
    <span class="c"># Display results</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">pred</span><span class="p">],</span> <span class="p">[</span><span class="s">'pred'</span><span class="p">])</span>
    <span class="n">pred</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'predictions at x='</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">new_x</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'Height of regression line at x='</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span><span class="o">+</span><span class="s">':'</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'Approximate 95%-confidence interval:'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">pred</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">pred</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mf">97.5</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_ht_m15</span><span class="p">(</span><span class="mi">173</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Height of regression line at x=173: 83.6569980146
Approximate 95%-confidence interval:
(74.714778270509967, 91.42206150583246)
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_30_1.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The figure above shows a bootstrap empirical histogram of the predicted 15-month score of a patient who is 173 cm tall. The empirical distribution is roughly normal. An approximate 95% prediction interval of scores ranges from about 74.7 to about 91.4. The prediction based on the original sample was about 83.6, which is close to the center of the interval.</p>
<p>The figure below shows the corresponding figure for a patient whose height is 163 cm. Notice that while this empirical histogram too is roughly bell shaped, the approximation is not as good as the one above for a given height of 173 cm. Also, the distribution is more spread out than the one above. That is because 163 cm is near the low end of the heights of the sampled patients, and there is not much data around a height of 163 cm. By contrast, several patients were 173 cm tall. Therefore we can make better predictions for patients who are 173 cm tall than for patients whose height is 163 cm.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_ht_m15</span><span class="p">(</span><span class="mi">163</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Height of regression line at x=163: 73.6943604671
Approximate 95%-confidence interval:
(61.330870268521551, 82.356639766521468)
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_32_1.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The function <code>bootstrap_pred</code> returns an approximate 95% prediction interval and a bootstrap empirical distribution of the prediction. Its arguments are:</p>
<ul>
<li>the name of the table containing the data</li>
<li>the label of the column containing the known variable, $x$</li>
<li>the label of the column containing the variable to be predicted, $y$</li>
<li>the value of $x$ at which to make the prediction</li>
<li>the number of repetitions of the bootstrap resampling procedure</li>
</ul>
<p>In every repetition, the function draws a bootstrap sample and finds the fitted value at the specified value of $x$. Below, the function has been called to make a prediction at a height of 180 cm.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">bootstrap_pred</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_x</span><span class="p">,</span> <span class="n">column_y</span><span class="p">,</span> <span class="n">new_x</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">):</span>
    
    <span class="c"># For each repetition:</span>
    <span class="c"># Bootstrap the scatter; </span>
    <span class="c"># get the regression prediction at new_x </span>
    <span class="c"># augment the predictions list</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
        <span class="n">bootstrap_sample</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">fit</span><span class="p">(</span><span class="n">bootstrap_sample</span><span class="p">,</span> <span class="n">column_x</span><span class="p">,</span> <span class="n">column_y</span><span class="p">,</span> <span class="n">new_x</span><span class="p">)</span>
        <span class="n">pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    
    <span class="c"># Prediction based on regression line through original sample</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">fit</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_x</span><span class="p">,</span> <span class="n">column_y</span><span class="p">,</span> <span class="n">new_x</span><span class="p">)</span>
    
    <span class="c"># Display results</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">pred</span><span class="p">],</span> <span class="p">[</span><span class="s">'pred'</span><span class="p">])</span>
    <span class="n">pred</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'predictions at x='</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">new_x</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'Height of regression line at x='</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span><span class="o">+</span><span class="s">':'</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'Approximate 95%-confidence interval:'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">pred</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">pred</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mf">97.5</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_pred</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">,</span> <span class="s">'height'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Height of regression line at x=180: 90.6308442979
Approximate 95%-confidence interval:
(78.368435768539257, 99.266211225997026)
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_35_1.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Is-there-a-linear-trend-at-all?">Is there a linear trend at all?<a class="anchor-link" href="#Is-there-a-linear-trend-at-all?">¶</a></h2><p>The bootstrap method can also be used to see whether there is any correlation between two variables.</p>
<p>From the scatter plot below, it appears that there is little or no correlation between the amont of radiation patients received and their 15-month score</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">scatter_fit</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">,</span> <span class="s">'rad'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_37_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To see whether this lack of linear relation is true, we can create a bootstrap confidence interval for the slope of the true line, analogously to the confidence intervals we constructed in earlier sections using the bootstrap percentile method.</p>
<p>The figure below shows the empirical distribution of the slopes and an approximate 95% confidence interval for the true slope. The interval runs from about -0.05 to 0.05, and contains the slope of 0. There is no strong reason to doubt that the slope of the true line is around 0.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">bootstrap_slope</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_x</span><span class="p">,</span> <span class="n">column_y</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">):</span>
    
    <span class="c"># For each repetition:</span>
    <span class="c"># Bootstrap the scatter, get the slope of the regression line,</span>
    <span class="c"># augment the results list</span>
    <span class="n">slopes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
        <span class="n">bootstrap_sample</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
        <span class="n">slopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">regress</span><span class="p">(</span><span class="n">bootstrap_sample</span><span class="p">,</span> <span class="n">column_x</span><span class="p">,</span> <span class="n">column_y</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c"># Slope of the regression line from the original sample</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">regress</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_x</span><span class="p">,</span> <span class="n">column_y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c"># Display results</span>
    <span class="n">slopes</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">slopes</span><span class="p">],[</span><span class="s">'slopes'</span><span class="p">])</span>
    <span class="n">slopes</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'slopes'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'Slope of regression line:'</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">'Approximate 95%-confidence interval:'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">slopes</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">slopes</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mf">97.5</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_slope</span><span class="p">(</span><span class="n">hodgkins</span><span class="p">,</span> <span class="s">'rad'</span><span class="p">,</span> <span class="s">'month15'</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Slope of regression line: 0.00640027743724
Approximate 95%-confidence interval:
(-0.054477794919830333, 0.057351221017303319)
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/Regression2_40_1.png"/></div></div>