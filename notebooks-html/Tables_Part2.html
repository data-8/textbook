<div id="ipython-notebook">
            <a class="interact-button" href="http://data8.berkeley.edu/hub/interact?repo=textbook&subPath=notebooks/Tables_Part2.ipynb&branch=gh-pages">Interact</a>
            
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$']],
      processEscapes: true
    }
  });
</script>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example:-Trends-in-the-Population-of-the-United-States">Example: Trends in the Population of the United States<a class="anchor-link" href="#Example:-Trends-in-the-Population-of-the-United-States">Â¶</a></h3></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are now ready to work with large tables of data. The file below contains "Annual Estimates of the Resident Population by Single Year of Age and Sex for the United States." Notice that <code>read_table</code> can read data directly from a URL.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">census_url</span> <span class="o">=</span> <span class="s1">'http://www.census.gov/popest/data/national/asrh/2014/files/NC-EST2014-AGESEX-RES.csv'</span>
<span class="n">full_census_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">census_url</span><span class="p">)</span>
<span class="n">full_census_table</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>SEX</th> <th>AGE</th> <th>CENSUS2010POP</th> <th>ESTIMATESBASE2010</th> <th>POPESTIMATE2010</th> <th>POPESTIMATE2011</th> <th>POPESTIMATE2012</th> <th>POPESTIMATE2013</th> <th>POPESTIMATE2014</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0   </td> <td>0   </td> <td>3944153      </td> <td>3944160          </td> <td>3951330        </td> <td>3963071        </td> <td>3926665        </td> <td>3945610        </td> <td>3948350        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>1   </td> <td>3978070      </td> <td>3978090          </td> <td>3957888        </td> <td>3966510        </td> <td>3978006        </td> <td>3943077        </td> <td>3962123        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>2   </td> <td>4096929      </td> <td>4096939          </td> <td>4090862        </td> <td>3971573        </td> <td>3979952        </td> <td>3992690        </td> <td>3957772        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>3   </td> <td>4119040      </td> <td>4119051          </td> <td>4111920        </td> <td>4102501        </td> <td>3983049        </td> <td>3992425        </td> <td>4005190        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>4   </td> <td>4063170      </td> <td>4063186          </td> <td>4077552        </td> <td>4122303        </td> <td>4112638        </td> <td>3994047        </td> <td>4003448        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>5   </td> <td>4056858      </td> <td>4056872          </td> <td>4064653        </td> <td>4087713        </td> <td>4132210        </td> <td>4123408        </td> <td>4004858        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>6   </td> <td>4066381      </td> <td>4066412          </td> <td>4073013        </td> <td>4074979        </td> <td>4097780        </td> <td>4143094        </td> <td>4134352        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>7   </td> <td>4030579      </td> <td>4030594          </td> <td>4043047        </td> <td>4083240        </td> <td>4084964        </td> <td>4108615        </td> <td>4154000        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>8   </td> <td>4046486      </td> <td>4046497          </td> <td>4025604        </td> <td>4053206        </td> <td>4093213        </td> <td>4095827        </td> <td>4119524        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>9   </td> <td>4148353      </td> <td>4148369          </td> <td>4125415        </td> <td>4035769        </td> <td>4063193        </td> <td>4104133        </td> <td>4106832        </td>
        </tr>
    </tbody>
</table>
<p>... (296 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Only the first 10 rows of the table are displayed. Later we will see how to display the entire table; however, this is typically not useful with large tables.</p>
<p>A <a href="http://www.census.gov/popest/data/national/asrh/2014/files/NC-EST2014-AGESEX-RES.pdf">description of the table</a> appears online. The <code>SEX</code> column contains numeric codes: <code>0</code> stands for the total, <code>1</code> for male, and <code>2</code> for female. The <code>AGE</code> column contains ages, but the special value <code>999</code> is a sum of the total population. The rest of the columns contain estimates of the US population.</p>
<p>Typically, a public table will contain more information than necessary for a particular investigation or analysis. In this case, let us suppose that we are only interested in the population changes from 2010 to 2014. Let us select the relevant columns.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">partial_census_table</span> <span class="o">=</span> <span class="n">full_census_table</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">'SEX'</span><span class="p">,</span> <span class="s1">'AGE'</span><span class="p">,</span> <span class="s1">'POPESTIMATE2010'</span><span class="p">,</span> <span class="s1">'POPESTIMATE2014'</span><span class="p">])</span>
<span class="n">partial_census_table</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>SEX</th> <th>AGE</th> <th>POPESTIMATE2010</th> <th>POPESTIMATE2014</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0   </td> <td>0   </td> <td>3951330        </td> <td>3948350        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>1   </td> <td>3957888        </td> <td>3962123        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>2   </td> <td>4090862        </td> <td>3957772        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>3   </td> <td>4111920        </td> <td>4005190        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>4   </td> <td>4077552        </td> <td>4003448        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>5   </td> <td>4064653        </td> <td>4004858        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>6   </td> <td>4073013        </td> <td>4134352        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>7   </td> <td>4043047        </td> <td>4154000        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>8   </td> <td>4025604        </td> <td>4119524        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>9   </td> <td>4125415        </td> <td>4106832        </td>
        </tr>
    </tbody>
</table>
<p>... (296 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also simplify the labels of the selected columns.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple</span> <span class="o">=</span> <span class="n">partial_census_table</span><span class="o">.</span><span class="n">relabeled</span><span class="p">(</span><span class="s1">'POPESTIMATE2010'</span><span class="p">,</span> <span class="s1">'2010'</span><span class="p">)</span><span class="o">.</span><span class="n">relabeled</span><span class="p">(</span><span class="s1">'POPESTIMATE2014'</span><span class="p">,</span> <span class="s1">'2014'</span><span class="p">)</span>
<span class="n">simple</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>SEX</th> <th>AGE</th> <th>2010</th> <th>2014</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0   </td> <td>0   </td> <td>3951330</td> <td>3948350</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>1   </td> <td>3957888</td> <td>3962123</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>2   </td> <td>4090862</td> <td>3957772</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>3   </td> <td>4111920</td> <td>4005190</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>4   </td> <td>4077552</td> <td>4003448</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>5   </td> <td>4064653</td> <td>4004858</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>6   </td> <td>4073013</td> <td>4134352</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>7   </td> <td>4043047</td> <td>4154000</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>8   </td> <td>4025604</td> <td>4119524</td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>9   </td> <td>4125415</td> <td>4106832</td>
        </tr>
    </tbody>
</table>
<p>... (296 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now have a table that is easy to work with. Each column of the table is an array of the same length, and so columns can be combined using arithmetic. Here is the change in population between 2010 and 2014.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'2014'</span><span class="p">)</span> <span class="o">-</span> <span class="n">simple</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'2010'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>array([  -2980,    4235, -133090, ...,    6717,   13410, 4662996])</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us augment <code>simple</code> with a column that contains these changes, both in absolute terms and as percents relative to the value in 2010.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">change</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'2014'</span><span class="p">)</span> <span class="o">-</span> <span class="n">simple</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'2010'</span><span class="p">)</span>
<span class="n">census</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="s1">'Change'</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span>
    <span class="s1">'Percent Change'</span><span class="p">,</span> <span class="n">change</span><span class="o">/</span><span class="n">simple</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'2010'</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">census</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s1">'Percent Change'</span><span class="p">,</span> <span class="n">PercentFormatter</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>SEX</th> <th>AGE</th> <th>2010</th> <th>2014</th> <th>Change</th> <th>Percent Change</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0   </td> <td>0   </td> <td>3951330</td> <td>3948350</td> <td>-2980  </td> <td>-0.08%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>1   </td> <td>3957888</td> <td>3962123</td> <td>4235   </td> <td>0.11%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>2   </td> <td>4090862</td> <td>3957772</td> <td>-133090</td> <td>-3.25%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>3   </td> <td>4111920</td> <td>4005190</td> <td>-106730</td> <td>-2.60%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>4   </td> <td>4077552</td> <td>4003448</td> <td>-74104 </td> <td>-1.82%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>5   </td> <td>4064653</td> <td>4004858</td> <td>-59795 </td> <td>-1.47%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>6   </td> <td>4073013</td> <td>4134352</td> <td>61339  </td> <td>1.51%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>7   </td> <td>4043047</td> <td>4154000</td> <td>110953 </td> <td>2.74%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>8   </td> <td>4025604</td> <td>4119524</td> <td>93920  </td> <td>2.33%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>9   </td> <td>4125415</td> <td>4106832</td> <td>-18583 </td> <td>-0.45%        </td>
        </tr>
    </tbody>
</table>
<p>... (296 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Sorting the data.</strong> Arranging data in increasing or decreasing order is often an important first step in data analysis. The method <code>sort</code> allows us to do this. By default, <code>sort</code> arranges values from smallest to largest. We will use the option <code>descending=True</code> to sort from largest to smallest.</p>
<p>Let us sort the table in decreasing order of the absolute change in population.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">census</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">'Change'</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>SEX</th> <th>AGE</th> <th>2010</th> <th>2014</th> <th>Change</th> <th>Percent Change</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0   </td> <td>999 </td> <td>309347057</td> <td>318857056</td> <td>9509999</td> <td>3.07%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>1   </td> <td>999 </td> <td>152089484</td> <td>156936487</td> <td>4847003</td> <td>3.19%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>2   </td> <td>999 </td> <td>157257573</td> <td>161920569</td> <td>4662996</td> <td>2.97%         </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>67  </td> <td>2693709  </td> <td>3485502  </td> <td>791793 </td> <td>29.39%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>64  </td> <td>2706063  </td> <td>3488136  </td> <td>782073 </td> <td>28.90%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>66  </td> <td>2621346  </td> <td>3347776  </td> <td>726430 </td> <td>27.71%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>65  </td> <td>2678532  </td> <td>3384449  </td> <td>705917 </td> <td>26.35%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>71  </td> <td>1953614  </td> <td>2519748  </td> <td>566134 </td> <td>28.98%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>34  </td> <td>3822188  </td> <td>4362895  </td> <td>540707 </td> <td>14.15%        </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0   </td> <td>23  </td> <td>4217221  </td> <td>4698584  </td> <td>481363 </td> <td>11.41%        </td>
        </tr>
    </tbody>
</table>
<p>... (296 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not surprisingly, the top row of the sorted table is the line that corresponds to the entire population: both sexes and all age groups. From 2010 to 2014, the population of the United States increased by about 9.5 million people, a change of just over 3%.</p>
<p>The next two rows correspond to all the men and all the women respectively. The male population grew more than the female population, both in absolute and percentage terms. Both percent changes were around 3%.</p>
<p>Now take a look at the next few rows. The percent change jumps from about 3% for the overall population to almost 30% for the people in their late sixties and early seventies. This stunning change contributes to what is known as the greying of America.</p></div></div></div>