<div id="ipython-notebook">
            <a class="interact-button" href="http://datahub.berkeley.edu/user-redirect/interact?repo=textbook&path=notebooks/trip.csv&path=notebooks/Confidence.ipynb">Interact</a>
            
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$']],
      processEscapes: true
    }
  });
</script>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whenever we analyze a random sample of a population, our goal is to draw robust conclusions about the whole population, despite the fact that we can measure only part of it. We must guard against being misled by the inevitable random variations in a sample. It is possible that a sample has very different characteristics than the population itself, but those samples are unlikely. It is much more typical that a random sample, especially a large simple random sample, is representative of the population. More importantly, the chance that a sample resembles the population is something that we know in advance, based on how we selected our random sample. Statistical inference is the practice of using this information to make precise statements about a population based on a random sample.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Statistics-and-Parameters">Statistics and Parameters<a class="anchor-link" href="#Statistics-and-Parameters">Â¶</a></h2><p>The <a href="http://www.bayareabikeshare.com/">Bay Area Bike Share</a> service published a <a href="http://www.bayareabikeshare.com/open-data">dataset</a> describing every bicycle rental from September 2014 to August 2015 in their system. This set of all trips is a population, and fortunately we have the data for each and every trip rather than just a sample. We'll focus only on the <em>free trips</em>, which are trips that last less than 1800 seconds (half an hour).</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">free_trips</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">"trip.csv"</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">below</span><span class="p">(</span><span class="mi">1800</span><span class="p">))</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">free_trips</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Start Station</th> <th>End Station</th> <th>Duration</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Harry Bridges Plaza (Ferry Building)         </td> <td>San Francisco Caltrain (Townsend at 4th)     </td> <td>765     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>San Antonio Shopping Center                  </td> <td>Mountain View City Hall                      </td> <td>1036    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Post at Kearny                               </td> <td>2nd at South Park                            </td> <td>307     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>San Jose City Hall                           </td> <td>San Salvador at 1st                          </td> <td>409     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Embarcadero at Folsom                        </td> <td>Embarcadero at Sansome                       </td> <td>789     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Yerba Buena Center of the Arts (3rd @ Howard)</td> <td>San Francisco Caltrain (Townsend at 4th)     </td> <td>293     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Embarcadero at Folsom                        </td> <td>Embarcadero at Sansome                       </td> <td>896     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Embarcadero at Sansome                       </td> <td>Steuart at Market                            </td> <td>255     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Beale at Market                              </td> <td>Temporary Transbay Terminal (Howard at Beale)</td> <td>126     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Post at Kearny                               </td> <td>South Van Ness at Market                     </td> <td>932     </td>
        </tr>
    </tbody>
</table>
<p>... (338333 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quantity measured for a whole population is called a <em>parameter</em>. For example, the average duration for any free trip between September 2014 to August 2015 can be computed exactly from these data: 550.00.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">free_trips</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>550.00143345658103</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we have information for the full population, we will investigate what we can learn from a simple random sample. Below, we sample 100 trips without replacement from <code>free_trips</code> not just once, but 40 different times. All 4000 trips are stored in a table called <code>samples</code>.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">'Sample #'</span><span class="p">,</span> <span class="s1">'Duration'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">trip</span> <span class="ow">in</span> <span class="n">free_trips</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">trip</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">)])</span>
<span class="n">samples</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Sample #</th> <th>Duration</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0       </td> <td>557     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>491     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>877     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>279     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>339     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>542     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>715     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>255     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>1543    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0       </td> <td>194     </td>
        </tr>
    </tbody>
</table>
<p>... (3990 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quantity measured for a sample is called a <em>statistic</em>. For example, the average duration of a free trip in a sample is a statistic, and we find that there is some variation across samples.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">sample_average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">'Sample #'</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Average duration in sample"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">"is"</span><span class="p">,</span> <span class="n">sample_average</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Average duration in sample 0 is 547.29
Average duration in sample 1 is 500.6
Average duration in sample 2 is 660.16
</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Often, the goal of analysis is to estimate parameters from statistics. Proper statistical inference involves more than just picking an estimate: we should also say something about how confident we should be in that estimate. A single guess is rarely sufficient to make a robust conclusion about a population. We also need to quantify in some way how precise we believe that guess to be.</p>
<p>Already we can see from the example above that the average duration of a sample is around 550, the parameter. Our goal is to quantify this notion of <em>around</em>, and one way to do so is to state a range of values.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Error-in-Estimates">Error in Estimates<a class="anchor-link" href="#Error-in-Estimates">Â¶</a></h2></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can learn a great deal about the behavior of a statistic by computing it for many samples. In the scatter diagram below, the order in which the statistic was computed appears on the horizontal axis, and the value of the average duration for a sample of <code>n</code> trips appears on the vertical axis.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">)</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_13_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sample number doesn't tell us anything beyond when the sample was selected, and we can see from this unstructured cloud of points that one sample does not affect the next in any consistent way. The sample averages are indeed all around 550. Some are above, and some are below.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">641</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_15_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are 40 averages for 40 samples. If we find an interval that contains the middle 38 out of 40, it will contain 95% of the samples. One such interval is bounded by the second smallest and the second largest sample averages among the 40 samples.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">averages</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">averages</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">averages</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Empirically, 95</span><span class="si">% o</span><span class="s1">f sample averages fell within the interval'</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="s1">'to'</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Empirically, 95% of sample averages fell within the interval 502.38 to 620.04
</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This statement gives us our first notion of a margin of error. If this statement were to hold up not just for our 40 samples, but for all samples, then a reasonable strategy for estimating the true population average would be to draw a 100-trip sample, compute its sample average, and guess that the true average was within <code>max_deviation</code> of this quantity. We would be right at least 95% of the time.</p>
<p>The problem with this approach is that finding the <code>max_deviation</code> required drawing many different samples, and we would like to be able to say something similar after having collected only one 100-trip sample.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Variability-Within-Samples">Variability Within Samples<a class="anchor-link" href="#Variability-Within-Samples">Â¶</a></h3><p>By contrast, The individual durations in the samples themselves are not closely clustered around 550. Instead, they span the whole range from 0 to 1800. The durations for the first three 100-item samples are visualized below. All have somewhat similar shapes; they were drawn from the same population.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">samples</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">'Sample #'</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1801</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_20_0.png"/></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_20_1.png"/></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_20_2.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have now observed two different ways in which the variation of a random sample can be observed: the statistics computed from those samples vary in magnitude, and the sampled quantities themselves vary in distribution. That is, there is variability <em>across samples</em>, which we see by comparing sample averages, and there is variability <em>within each sample</em>, which we see in the duration histograms above.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Percentiles">Percentiles<a class="anchor-link" href="#Percentiles">Â¶</a></h2><p>The 80th percentile of a collection of values is the smallest value in the collection that is at least as large as 80% of the values in the collection. Likewise, the 40th percentile is at least as large as 40% of the values.</p>
<p>For example, let's consider the sizes of the five largest continents: Africa, Antarctica, Asia, North America, and South America, rounded to the nearest million square miles.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The 20th percentile is the smallest value that is at least as large as 20% or one fifth of the elements.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">percentile</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">sizes</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>6</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The 60th percentile is at least as large as 60% or three fifths of the elements.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">percentile</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">sizes</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>9</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To find the element corresponding to a percentile $p$, sort the elements and take the $k$th element, where $k=\frac{p}{100} \times n$ where $n$ is the size of the collection. In general, any percentile from 0 to 100 can be computed for a collection of values, and it is always an element of the collection. If $k$ is not an integer, round it up to find the percentile element. For example, the 90th percentile of a five element set is the fifth element, because $\frac{90}{100} \times 5$ is 4.5, which rounds up to 5.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">percentile</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">sizes</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>17</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the <code>percentile</code> function is called with a single argument, it returns a function that computes percentiles of collections.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tenth</span> <span class="o">=</span> <span class="n">percentile</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tenth</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>6</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tenth</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>4</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tenth</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5000</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>499</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Confidence-Intervals">Confidence Intervals<a class="anchor-link" href="#Confidence-Intervals">Â¶</a></h2><p>Inference begins with a population: a collection that you can describe but often cannot measure directly. One thing we can often do with a populuation is to draw a simple random sample. By measuring a statistic of the sample, we may hope to estimate a parameter of the population. In this process, the population is not random, nor are its parameters. The sample is random, and so is its statistic. The whole process of estimation therefore gives a random result. It starts from a population (fixed), draws a sample (random), computes a statistic (random), and then estimates the parameter from the statistic (random). By calling the process random, we mean that the final estimate could have been different because the sample could have been different.</p>
<p>A confidence interval is one notion of a margin of error around an estimate. The margin of error acknowledges that the estimation process could have been misleading because of the variation in the sample. It gives a range that might contain the original parameter, along with a percentage of confidence. For example, a 95% confidence interval is one in which we would expect the interval to contain the true parameter for 95% of random samples. For any particular sample, any particular estimate, and any particular interval, the parameter is either contained or not; we never know for sure. The purpose of the confidence interval is to quantify how often our estimation process gives us a range containing the truth.</p>
<p>There are many different ways to compute a confidence interval. The challenge in computing a confidence interval from a single sample is that we don't know the population, and so we don't know how its samples will vary. One way to make progress despite this limited information is to assume that the variability <em>within the sample</em> is similar to the variability within the population.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Resampling-from-a-Sample">Resampling from a Sample<a class="anchor-link" href="#Resampling-from-a-Sample">Â¶</a></h3><p>Even though we happen to have the whole population of <code>free_trips</code>, let's imagine for a moment that we have only a single 100-trip sample from this population. That sample has 100 durations. Our goal now is to learn what we can about the population using just this sample.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">free_trips</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">sample</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Start Station</th> <th>End Station</th> <th>Duration</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Grant Avenue at Columbus Avenue    </td> <td>San Francisco Caltrain 2 (330 Townsend) </td> <td>877     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Embarcadero at Folsom              </td> <td>San Francisco Caltrain (Townsend at 4th)</td> <td>597     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Beale at Market                    </td> <td>Beale at Market                         </td> <td>67      </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>2nd at Folsom                      </td> <td>Washington at Kearny                    </td> <td>714     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Clay at Battery                    </td> <td>Embarcadero at Sansome                  </td> <td>510     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>South Van Ness at Market           </td> <td>Powell Street BART                      </td> <td>494     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>San Jose Diridon Caltrain Station  </td> <td>MLK Library                             </td> <td>530     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Mechanics Plaza (Market at Battery)</td> <td>Clay at Battery                         </td> <td>286     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>South Van Ness at Market           </td> <td>Civic Center BART (7th at Market)       </td> <td>172     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Broadway St at Battery St          </td> <td>5th at Howard                           </td> <td>551     </td>
        </tr>
    </tbody>
</table>
<p>... (90 rows omitted)</p></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">))</span>
<span class="n">average</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>518.55999999999995</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A technique called <em>bootstrap resampling</em> uses the variability of the sample as a proxy for the variability of the population. Instead of drawing many samples from the population, we will draw many samples from the sample. Since the original sample and the re-sampled sample have the same size, we must draw with replacement in order to see any variability at all.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resamples</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">'Resample #'</span><span class="p">,</span> <span class="s1">'Duration'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>
    <span class="n">resample</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">trip</span> <span class="ow">in</span> <span class="n">resample</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">resamples</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">trip</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">)])</span>
<span class="n">resamples</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Resample #</th> <th>Duration</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0         </td> <td>329     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>252     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>252     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>685     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>434     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>396     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>434     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>585     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>394     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>0         </td> <td>202     </td>
        </tr>
    </tbody>
</table>
<p>... (3990 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the <code>resamples</code>, we can investigate the variability of the corresponding sample averages.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resamples</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">)</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_41_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These sample averages are not necessarily clustered around the true average 550. Instead, they will be clustered around the average of the sample from which they were re-sampled.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resamples</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">641</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_43_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the center of this distribution is not the same as the true population average, its variability is similar.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bootstrap-Confidence-Interval">Bootstrap Confidence Interval<a class="anchor-link" href="#Bootstrap-Confidence-Interval">Â¶</a></h3><p>A technique called <em>bootstrap resampling</em> estimates a confidence interval using resampling. To find a confidence interval, we must estimate how much the sample statistic deviates from the population parameter. The boostrap assumes that a resampled statistic will deviate from the sample statistic in approximately the same way that the sample statistic deviates from the parameter.</p>
<p>To carry out the technique, we first compute the deviations from the sample statistic (in this case, the sample average) for many resampled samples. The number is arbitrary, and it doesn't require any collecting of new data; 1000 or more is typical.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deviations</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">'Resample #'</span><span class="p">,</span> <span class="s1">'Deviation'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">resample</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dev</span> <span class="o">=</span> <span class="n">average</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">resample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">deviations</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">dev</span><span class="p">])</span>
<span class="n">deviations</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Resample #</th> <th>Deviation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0         </td> <td>30.95    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>1         </td> <td>41.16    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>2         </td> <td>3.37     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>3         </td> <td>2.54     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>4         </td> <td>-22.87   </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>5         </td> <td>27.63    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>6         </td> <td>49.93    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>7         </td> <td>11.91    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>8         </td> <td>26.32    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>9         </td> <td>-5.97    </td>
        </tr>
    </tbody>
</table>
<p>... (990 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A deviation of zero indicates that the resampled statistic is the same as the sampled statistic. That's evidence that the sample statistic is perhaps the same as the population parameter. A positive deviation is evidence that the sample statistic may be greater than the parameter. As we can see, for averages, the distribution of deviations is roughly symmetric.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deviations</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_48_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A 95% confidence interval is computed based on the middle 95% of this distribution of deviations. The max and min devations are computed by the 97.5th percentile and 2.5th percentile respectively, because the span between these contains 95% of the distribution.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lower</span> <span class="o">=</span> <span class="n">average</span> <span class="o">-</span> <span class="n">percentile</span><span class="p">(</span><span class="mf">97.5</span><span class="p">,</span> <span class="n">deviations</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">lower</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>461.93000000000001</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">upper</span> <span class="o">=</span> <span class="n">average</span> <span class="o">-</span> <span class="n">percentile</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">deviations</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">upper</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>576.29999999999995</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we have not only an estimate, but an interval around it that expresses our uncertainty about the value of the parameter.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'A 95</span><span class="si">% c</span><span class="s1">onfidence interval around'</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="s1">'to'</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>A 95% confidence interval around 518.56 is 461.93 to 576.3
</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And behold, the interval happens to contain the true parameter 550. Normally, after generating a confidence interval, there is no way to check that it is correct, because to do so requires access to the entire population. In this case, we started with the whole population in a single table, and so we are able to check.</p>
<p>The following function encapsulates the entire process of producing a confidence interval for the population average using a single sample.  Each time it is run, even for the same sample, the interval will be slightly different because of the random variation of resampling. However, the upper and lower bounds generated by 2000 samples for this problem are typically quite similar for multiple calls.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">average_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">deviations</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">'Resample #'</span><span class="p">,</span> <span class="s1">'Deviation'</span><span class="p">])</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">num_rows</span>
    <span class="n">average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">resample</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">resample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label</span><span class="p">))</span> <span class="o">-</span> <span class="n">average</span>
        <span class="n">deviations</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">dev</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">average</span> <span class="o">-</span> <span class="n">percentile</span><span class="p">(</span><span class="mf">97.5</span><span class="p">,</span> <span class="n">deviations</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
            <span class="n">average</span> <span class="o">-</span> <span class="n">percentile</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">deviations</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">average_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s1">'Duration'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>(457.43999999999994, 572.63999999999987)</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">average_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s1">'Duration'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>(458.7399999999999, 575.50999999999988)</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, if we draw an entirely new sample, then the confidence interval will change.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">average_ci</span><span class="p">(</span><span class="n">free_trips</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s1">'Duration'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>(530.18000000000006, 661.21000000000004)</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The interval is about the same width, and that's typical of multiple samples of the same size drawn from the same population. However, if a much larger sample is drawn, then the confidence interval that results is typically going to be much smaller. We're not losing confidence in this case; we're just using more evidence to perform inference, and so we have less uncertainty about the full population.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">average_ci</span><span class="p">(</span><span class="n">free_trips</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="n">n</span><span class="p">),</span> <span class="s1">'Duration'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>(527.18937499999993, 555.11437499999988)</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluating-Confidence-Intervals">Evaluating Confidence Intervals<a class="anchor-link" href="#Evaluating-Confidence-Intervals">Â¶</a></h3><p>When given only a sample, it is not possible to check whether the parameter was estimated correctly. However, in the case of the Bay Area Bike Share, we have not only the sample, but many samples and the whole population. Therefore, we can check how often the confidence intervals we compute in this way do in fact contain the true parameter.</p>
<p>Before measuring the accuracy of our technique, we can visualize the result of resampling each sample. The following scatter diagram has 6 vertical lines for 6 samples, and each line consists of 100 points that represent the statistics from resamples for that sample.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">'Sample #'</span><span class="p">,</span> <span class="s1">'Resample average'</span><span class="p">,</span> <span class="s1">'Sample Average'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">free_trips</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">resample</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">resample_average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">resample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">))</span>
        <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">resample_average</span><span class="p">,</span> <span class="n">average</span><span class="p">])</span>
<span class="n">samples</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_62_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see from the plot above that for almost every sample, there are some resampled averages above 550 and some below. When we use these resampled averages to compute confidence intervals, many of those intervals contain 550 as a result.</p>
<p>Below, we draw 100 more samples and show the upper and lower bounds of the confidence intervals computed from each one.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">intervals</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">'Sample #'</span><span class="p">,</span> <span class="s1">'Lower'</span><span class="p">,</span> <span class="s1">'Estimate'</span><span class="p">,</span> <span class="s1">'Upper'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">free_trips</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Duration'</span><span class="p">))</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">average_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s1">'Duration'</span><span class="p">)</span>
    <span class="n">intervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">upper</span><span class="p">])</span>
</pre></div></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can compute precisely which intervals contain the truth, and we should find that about 95 of them do.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">intervals</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Lower'</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">550</span><span class="p">,</span> <span class="n">intervals</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Upper'</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">550</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>97</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each confidence interval is generated from only a single sample of 100 trips. As a result, the width of the interval varies quite a bit as well. Compared to the interval width we computed originally (which required multiple samples), we see that some of these intervals are much more narrow and some are much wider.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s1">'Width'</span><span class="p">,</span> <span class="n">intervals</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Upper'</span><span class="p">)</span><span class="o">-</span><span class="n">intervals</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">'Lower'</span><span class="p">))</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="/notebooks-images/Confidence_68_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given a single sample, it is impossible to know whether you have correctly estimated the parameter or not. However, you can infer a precise notion of confidence by following a process based on random sampling.</p></div></div></div>